<md-toolbar class="md-menu-toolbar">
  <div layout="row">
    <md-toolbar-filler layout="" layout-align="center center">
    </md-toolbar-filler>

    <div>
      <h2 class="md-toolbar-tools">Editor</h2>
      <md-menu-bar>
        <md-menu>
          <button ng-click="$mdOpenMenu()">
            File
          </button>
          <md-menu-content>
            <md-menu-item>
              <md-button ng-model="img_file" ngf-select="vm.openFile($file)" ngf-pattern="'image/*'" ngf-accept="'image/*'">Open Image</md-button>
            </md-menu-item>
            <md-menu-item>
              <md-button ng-model="zip_file" ngf-select="vm.openZip($file)" ngf-pattern="'application/*'"
                         ngf-accept="'application/zip'">Open Zip
              </md-button>
            </md-menu-item>
            <md-menu-item>
              <md-button ng-click="vm.saveCurrent();" ng-disabled="!vm.canSave()">Save Current Terrain</md-button>
            </md-menu-item>
          </md-menu-content>
        </md-menu>
      </md-menu-bar>
    </div>
  </div>
</md-toolbar>

<div layout="row" flex>


  <terrain-viewer layout="column" flex terrain="vm.terrain"></terrain-viewer>

  <md-content layout-padding layout="column">
    <form name="settingsForm">
      <h4>Generation Phase</h4>
      <md-content layout-padding layout="column">
        <md-input-container>
          <label>Surface Size</label>
          <md-select ng-model="surface_size">
            <md-option ng-value="16">16</md-option>
            <md-option ng-value="32">32</md-option>
            <md-option ng-value="64">64</md-option>
            <md-option ng-value="128">128</md-option>
            <md-option ng-value="256">256</md-option>
            <md-option ng-value="512">512</md-option>
            <md-option ng-value="1024">1024</md-option>
            <md-option ng-value="2048">2048</md-option>
          </md-select>
        </md-input-container>
        <md-input-container>
          <label>Random Method</label>
          <md-select ng-model="random_method" ng-change="vm.random_method_changed()">
            <md-option ng-repeat="method in random_methods" ng-value="method.ordinal">
              {{method.description}}
            </md-option>
          </md-select>
        </md-input-container>

        <md-content layout-padding layout="column" ng-show="vm.is_random_method_fourier()">
          <md-input-container class="md-block">
            <label>Filter Power</label>
            <input
                ng-model="fourier_synthesis.power"
                ng-change="vm.random_parameter_changed()"
                ng-model-options="{ debounce: 100 }"
                type="number"
                step="0.01"
                min="0.01"
                max="2.99"
                required/>
          </md-input-container>
        </md-content>

        <md-content layout-padding layout="column" ng-show="vm.is_random_method_perlin_noise()">

          <md-input-container class="md-block">
            <label>Frequency</label>
            <input
                ng-model="perlin_noise.frequency"
                ng-change="vm.random_parameter_changed()"
                ng-model-options="{ debounce: 100 }"
                type="number"
                step="1"
                min="1"
                max="2000"
                required/>
          </md-input-container>
          <md-input-container class="md-block">
            <label>Octaves</label>
            <input
                ng-model="perlin_noise.octaves"
                ng-change="vm.random_parameter_changed()"
                ng-model-options="{ debounce: 100 }"
                type="number"
                step="1"
                min="1"
                max="20"
                required/>
          </md-input-container>
          <md-input-container class="md-block">
            <label>Persistence</label>
            <input
                ng-model="perlin_noise.persistence"
                ng-change="vm.random_parameter_changed()"
                ng-model-options="{ debounce: 100 }"
                type="number"
                step="0.01"
                min="0.01"
                max="10.0"
                required/>
          </md-input-container>
          <md-input-container class="md-block">
            <label>Lacunarity</label>
            <input
                ng-model="perlin_noise.lacunarity"
                ng-change="vm.random_parameter_changed()"
                ng-model-options="{ debounce: 100 }"
                type="number"
                step="0.01"
                min="0.01"
                max="10.0"
                required/>
          </md-input-container>
          <md-input-container class="md-block">
            <label>Base</label>
            <input
                ng-model="perlin_noise.base"
                ng-change="vm.random_parameter_changed()"
                ng-model-options="{ debounce: 100 }"
                type="number"
                step="0.01"
                min="0.0"
                max="20"
                required/>
          </md-input-container>

        </md-content>

        <md-content layout-padding layout="column" ng-show="vm.is_random_method_simplex_noise()">

          <md-input-container class="md-block">
            <label>Frequency</label>
            <input
                ng-model="simplex_noise.frequency"
                ng-change="vm.random_parameter_changed()"
                ng-model-options="{ debounce: 100 }"
                type="number"
                step="1"
                min="1"
                max="2000"
                required/>
          </md-input-container>
          <md-input-container class="md-block">
            <label>Octaves</label>
            <input
                ng-model="simplex_noise.octaves"
                ng-change="vm.random_parameter_changed()"
                ng-model-options="{ debounce: 100 }"
                type="number"
                step="1"
                min="1"
                max="20"
                required/>
          </md-input-container>
          <md-input-container class="md-block">
            <label>Persistence</label>
            <input
                ng-model="simplex_noise.persistence"
                ng-change="vm.random_parameter_changed()"
                ng-model-options="{ debounce: 100 }"
                type="number"
                step="0.01"
                min="0.01"
                max="10.0"
                required/>
          </md-input-container>
          <md-input-container class="md-block">
            <label>Lacunarity</label>
            <input
                ng-model="simplex_noise.lacunarity"
                ng-change="vm.random_parameter_changed()"
                ng-model-options="{ debounce: 100 }"
                type="number"
                step="0.01"
                min="0.01"
                max="10.0"
                required/>
          </md-input-container>
          <md-input-container class="md-block">
            <label>Base</label>
            <input
                ng-model="simplex_noise.base"
                ng-change="vm.random_parameter_changed()"
                ng-model-options="{ debounce: 100 }"
                type="number"
                step="0.01"
                min="0.0"
                max="20"
                required/>
          </md-input-container>

        </md-content>

      </md-content>
      <md-content>
        <md-button ng-click="vm.generate_surface()" ng-disabled="settingsForm.$invalid || !vm.can_generate()">
          <span>Generate</span>
        </md-button>
      </md-content>
      <md-divider></md-divider>

      <h4>Blend Phase</h4>
      <md-content layout-padding layout="column">
        <md-input-container>
          <label>Mapping</label>
          <spline-editor
              ng-change="vm.spline_changed()"
              ng-model="blend.mapping_data">
          </spline-editor>
        </md-input-container>
        <md-input-container>
          <label>Blend Strength</label>
          <input
              ng-model="blend.strength"
              ng-change="vm.blend_strength_changed()"
              ng-model-options="{ debounce: 100 }"
              type="number"
              step="1"
              min="1"
              max="500"/>
        </md-input-container>
        <div layout="row">
          <md-input-container>
            <label>Result min height</label>
            <input
                ng-model="blend.minimum"
                ng-change="vm.result_bounds_changed()"
                ng-model-options="{ debounce: 100 }"
                type="number"
                step="1"
                min="0"
                max="{{blend.maximum - 1}}"
            />
          </md-input-container>
          <md-input-container>
            <label>Result max height</label>
            <input
                ng-model="blend.maximum"
                ng-change="vm.result_bounds_changed()"
                ng-model-options="{ debounce: 100 }"
                type="number"
                step="1"
                min="{{blend.minimum + 1}}"
                max="255"
            />
          </md-input-container>
        </div>
      </md-content>

      <md-content>
        <md-button ng-click="vm.enable_detail()" ng-disabled="settingsForm.$invalid || !vm.can_add_detail()">
          <span>Add detail</span>
        </md-button>
      </md-content>
    </form>
  </md-content>

  <md-content layout-padding ng-show="vm.images.length">
    <md-button class="md-primary" ng-click="vm.remove_all_images()">Remove All</md-button>
    <md-list class="image-list md-3-line">
      <md-list-item ng-repeat="image in vm.images track by $index">
        <img src="{{image}}" ng-click="vm.show_image($event, image)"/>

        <md-menu>
          <md-icon ng-click="$mdOpenMenu()">more_vert</md-icon>
          <md-menu-content>
            <md-menu-item>
              <md-button href="{{image}}" download="image{{$index+1}}.png" ng-click="$mdCloseMenu()">Save</md-button>
            </md-menu-item>
            <md-menu-item>
              <md-button ng-click="$mdCloseMenu(); vm.remove_image($index)">Remove</md-button>
              </a></md-menu-item>
          </md-menu-content>
        </md-menu>
      </md-list-item>
    </md-list>
  </md-content>
</div>